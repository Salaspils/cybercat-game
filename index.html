<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>CyberCat v52.0: Hard Fix</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Segoe UI', sans-serif; }
        #ui { position: fixed; top: 20px; left: 20px; z-index: 100; pointer-events: none; }
        .hud { background: rgba(0,0,0,0.9); border: 1px solid #ffcc00; padding: 15px; border-radius: 8px; color: #fff; width: 220px; }
        .btns { position: fixed; bottom: 30px; width: 100%; display: flex; justify-content: center; gap: 10px; pointer-events: auto; }
        .btn { background: #111; color: #ffcc00; border: 1px solid #ffcc00; padding: 10px; cursor: pointer; font-size: 10px; font-weight: bold; }
        #status { font-size: 10px; color: #ff00ff; margin-top: 5px; }
    </style>
</head>
<body>
    <div id="ui">
        <div class="hud">
            <div id="clock" style="font-size: 28px; font-weight: 900;">12:00</div>
            <div style="color: #00ffcc;">$MEOW: <b id="bal">0</b></div>
            <div id="status">–ü–†–û–í–ï–†–ö–ê –§–ê–ô–õ–û–í...</div>
        </div>
    </div>
    <div class="btns">
        <button class="btn" onclick="db.board = !db.board">üõπ –ë–£–°–¢</button>
        <button class="btn" onclick="buildShed()">üèóÔ∏è –°–ê–†–ê–ô (900)</button>
        <button class="btn" onclick="plantGarden()">üå± –û–ì–û–†–û–î (150)</button>
        <button class="btn" onclick="sellAll()">üè™ –†–´–ù–û–ö</button>
    </div>

    <script>
        let db = JSON.parse(localStorage.getItem('cyber_v52')) || { bal: 1000, builds: [], gardens: [], energy: 100, time: 1.5 };

        async function loadEngine() {
            const status = document.getElementById('status');
            const sources = ['./three.min.js', 'https://unpkg.com'];
            
            for (let url of sources) {
                try {
                    status.innerText = "–ó–ê–ì–†–£–ó–ö–ê: " + url;
                    const resp = await fetch(url);
                    if (!resp.ok) continue;
                    const code = await resp.text();
                    const script = document.createElement('script');
                    script.textContent = code;
                    document.head.appendChild(script);
                    status.innerText = "ENGINE READY | RTX ACTIVE";
                    initGame();
                    return;
                } catch (e) { console.log("Skip source: " + url); }
            }
            status.innerText = "–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: –î–í–ò–ñ–û–ö –ù–ï –ù–ê–ô–î–ï–ù";
        }

        function initGame() {
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 2000);
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            scene.add(new THREE.AmbientLight(0xffffff, 0.5));
            const sun = new THREE.DirectionalLight(0xffccaa, 1); sun.position.set(50, 100, 50); scene.add(sun);
            scene.add(new THREE.GridHelper(1000, 40, 0x222222, 0x111111));

            const cat = new THREE.Mesh(new THREE.BoxGeometry(1.5, 1, 2), new THREE.MeshStandardMaterial({color: 0x333}));
            cat.position.y = 0.5; scene.add(cat);
            let target = new THREE.Vector3(0, 0, 0);

            window.addEventListener('pointerdown', (e) => {
                const m = new THREE.Vector2((e.clientX/window.innerWidth)*2-1, -(e.clientY/window.innerHeight)*2+1);
                const ray = new THREE.Raycaster(); ray.setFromCamera(m, camera);
                const hit = new THREE.Vector3();
                if(ray.ray.intersectPlane(new THREE.Plane(new THREE.Vector3(0,1,0), 0), hit)) target.copy(hit);
            });

            function animate() {
                requestAnimationFrame(animate);
                cat.position.lerp(target, 0.1);
                cat.lookAt(target.x, 0, target.z);
                camera.position.lerp(new THREE.Vector3(cat.position.x, 60, cat.position.z + 70), 0.05);
                camera.lookAt(cat.position);
                renderer.render(scene, camera);
            }
            animate();
        }

        loadEngine();
    </script>
</body>
</html>
