html
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CyberFarm 2026: DX11 Life</title>
    <script src="https://cdn.jsdelivr.net"></script>
    <style>
        body { margin: 0; overflow: hidden; background: #050200; font-family: 'Orbitron', sans-serif; }
        #ui { position: fixed; top: 20px; left: 20px; z-index: 100; color: #fff; pointer-events: none; }
        .hud { background: rgba(0,0,0,0.7); border: 2px solid #8b4513; padding: 15px; border-radius: 10px; backdrop-filter: blur(10px); box-shadow: 0 0 30px rgba(255, 204, 0, 0.2); }
        #energy-bar { width: 200px; height: 10px; background: #222; border: 1px solid #ffcc00; margin-top: 10px; border-radius: 5px; overflow: hidden; }
        #energy-fill { height: 100%; background: linear-gradient(90deg, #ffcc00, #ff6600); width: 100%; transition: 0.3s; }
        .btns { position: fixed; bottom: 30px; width: 100%; display: flex; justify-content: center; gap: 15px; pointer-events: auto; }
        .btn { background: #4a2c1d; color: #ffcc00; border: 2px solid #8b4513; padding: 12px 25px; cursor: pointer; font-weight: bold; text-transform: uppercase; border-radius: 5px; transition: 0.2s; }
        .btn:hover { background: #8b4513; color: #fff; transform: scale(1.05); }
    </style>
</head>
<body>
    <div id="ui">
        <div class="hud">
            <div style="font-size: 28px; color: #ffcc00;">$MEOW: <b id="bal">0</b></div>
            <div id="energy-bar"><div id="energy-fill"></div></div>
            <div style="margin-top:10px; font-size: 14px; opacity: 0.8;">–§–ï–†–ú–ê: <span id="animal-count">0</span> –ñ–ò–í–û–¢–ù–´–•</div>
        </div>
    </div>

    <div class="btns">
        <button class="btn" onclick="buildLogCabin()">üèóÔ∏è –°–†–£–ë (700)</button>
        <button class="btn" onclick="sellFarmGoods()" style="color: #00ffcc; border-color: #008877;">üè™ –ü–†–û–î–ê–¢–¨ –í–°–Å</button>
    </div>

    <script>
        let db = JSON.parse(localStorage.getItem('cyberfarm_v8')) || { bal: 1000, inv: 0, nrg: 100 };

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x1a0a05); // –ó–∞–∫–∞—Ç–Ω–æ–µ –Ω–µ–±–æ
        scene.fog = new THREE.FogExp2(0x1a0a05, 0.005);

        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 3000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        document.body.appendChild(renderer.domElement);

        // –°–í–ï–¢ DX11
        const sun = new THREE.DirectionalLight(0xffaa44, 2);
        sun.position.set(150, 200, 100);
        sun.castShadow = true;
        scene.add(sun, new THREE.AmbientLight(0x222244, 0.6));

        // –ó–ï–ú–õ–Ø
        const ground = new THREE.Mesh(new THREE.PlaneGeometry(3000, 3000), new THREE.MeshStandardMaterial({ color: 0x111111, roughness: 0.9 }));
        ground.rotation.x = -Math.PI / 2;
        ground.receiveShadow = true;
        scene.add(ground);

        // –ò–ì–†–û–ö
        const player = new THREE.Mesh(new THREE.SphereGeometry(1.5, 32, 32), new THREE.MeshStandardMaterial({ color: 0xffcc00, metalness: 0.8, roughness: 0.2 }));
        player.position.y = 1.5;
        player.castShadow = true;
        scene.add(player);
        let targetPos = new THREE.Vector3(0, 1.5, 0);

        // –≠–ö–û–°–ò–°–¢–ï–ú–ê (–ñ–ò–í–û–¢–ù–´–ï –ò –î–ï–†–ï–í–¨–Ø)
        const entities = [];
        function spawnEntity(type) {
            const group = new THREE.Group();
            let mat = new THREE.MeshStandardMaterial({ roughness: 0.7 });
            
            if(type === 'chicken') {
                const b = new THREE.Mesh(new THREE.BoxGeometry(0.6, 0.8, 0.6), mat); b.material.color.set(0xffffff);
                group.add(b); group.userData = { type: 'chicken', value: 10, speed: 0.4 };
            } else if(type === 'pig') {
                const b = new THREE.Mesh(new THREE.BoxGeometry(1.5, 1, 2), mat); b.material.color.set(0xffaaaa);
                group.add(b); group.userData = { type: 'pig', value: 50, speed: 0.15 };
            } else if(type === 'tree') {
                const trunk = new THREE.Mesh(new THREE.CylinderGeometry(0.5, 0.8, 8), mat); trunk.material.color.set(0x3d2b1f);
                const leaves = new THREE.Mesh(new THREE.SphereGeometry(3), mat); leaves.material.color.set(0x1a3d1a);
                leaves.position.y = 5; group.add(trunk, leaves);
                group.userData = { type: 'tree', value: 100, speed: 0 };
            }
            
            group.position.set((Math.random()-0.5)*400, 0, (Math.random()-0.5)*400);
            if(type !== 'tree') group.position.y = 0.5;
            group.castShadow = true;
            scene.add(group);
            entities.push(group);
        }

        // –ó–∞—Å–µ–ª—è–µ–º —Ñ–µ—Ä–º—É
        for(let i=0; i<30; i++) spawnEntity('chicken');
        for(let i=0; i<10; i++) spawnEntity('pig');
        for(let i=0; i<40; i++) spawnEntity('tree');

        window.buildLogCabin = () => {
            if(db.bal >= 700) {
                db.bal -= 700;
                const cabin = new THREE.Group();
                const wood = new THREE.MeshStandardMaterial({ color: 0x5d4037, roughness: 0.9 });
                for(let i=0; i<6; i++) {
                    const log = new THREE.Mesh(new THREE.CylinderGeometry(0.8, 0.8, 12, 8), wood);
                    log.rotation.z = Math.PI/2; log.position.y = i * 1.5; log.castShadow = true;
                    cabin.add(log);
                }
                cabin.position.set(player.position.x, 1, player.position.z);
                scene.add(cabin); updateUI();
            }
        };

        window.sellFarmGoods = () => { if(db.inv > 0) { db.bal += db.inv; db.inv = 0; updateUI(); } };

        window.addEventListener('pointerdown', (e) => {
            const mouse = new THREE.Vector2((e.clientX/window.innerWidth)*2-1, -(e.clientY/window.innerHeight)*2+1);
            const ray = new THREE.Raycaster();
            ray.setFromCamera(mouse, camera);
            const intersect = new THREE.Vector3();
            ray.ray.intersectPlane(new THREE.Plane(new THREE.Vector3(0,1,0), 0), intersect);
            targetPos.copy(intersect).y = 1.5;
        });

        function updateUI() {
            document.getElementById('bal').innerText = Math.floor(db.bal);
            document.getElementById('energy-fill').style.width = db.nrg + '%';
            document.getElementById('animal-count').innerText = entities.length;
            localStorage.setItem('cyberfarm_v8', JSON.stringify(db));
        }

        function animate() {
            requestAnimationFrame(animate);
            player.position.lerp(targetPos, 0.1);

            entities.forEach((ent, idx) => {
                if(ent.userData.speed > 0) { // –î–≤–∏–∂–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω—ã—Ö
                    ent.position.x += (Math.random()-0.5) * ent.userData.speed;
                    ent.position.z += (Math.random()-0.5) * ent.userData.speed;
                }
                
                const dist = ent.position.distanceTo(player.position);
                if(dist < 4 && db.nrg > 10) {
                    db.inv += ent.userData.value;
                    db.nrg -= 5;
                    // "–°–±–æ—Ä" –æ–±—ä–µ–∫—Ç–∞
                    ent.position.set((Math.random()-0.5)*400, ent.position.y, (Math.random()-0.5)*400);
                    updateUI();
                }
            });

            if(db.nrg < 100) db.nrg += 0.05;
            camera.position.lerp(new THREE.Vector3(player.position.x, 50, player.position.z + 60), 0.05);
            camera.lookAt(player.position);
            renderer.render(scene, camera);
        }
        updateUI(); animate();
    </script>
</body>
</html>
